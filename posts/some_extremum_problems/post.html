<html>
<head>
    <title>some extremum problems</title>

    <link rel="stylesheet"href="../../css/main.css">

    <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'>
    </script>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                processEscapes: true
            },
            displayAlign: "center"
        });
    </script>

    <style>
    .eq{ text-align: center; }
    @media print {
        .breaker {page-break-after: always;}
    }
    </style>
</head>
<body>
<div class="page-content">
<div class="wrap">
<div class="post">




<div class="post-header"></div>

<div class="post-content">

    <!-- ********************************************************** -->
    <!-- ********************************************************** -->

    <h2>Example 1</h2>
    <p>Determine the relative extrema of</p>

    <p class="eq">
        $f(x,y) = 2x^2 + y^2 + 8x - 6y + 20$
    </p>

    <p>finding the critical points of $f$ first involves finding the partial derivatives of $f$ with respect to $x$ and $y$:<p>

    <p class="eq">
        $f_x(x,y) = 4x + 8$
        <br/>
        $f_y(x,y) = 2y + 6$
    </p>

    <p> We can see from DEF 2 #2 (see below) that we wont be able to find a point
        $(x_0,y_0)$ that satisfies condition #2 because both $f_x$ and $f_y$ are defined
        at every point in their domains. However, we can find a point $(x_0,y_0)$ that satisfies condition #1 by setting $f_x(x,y) = 0$ and $f_y(x,y) = 0$.
    </p>

    <p class="eq">
        Solving $4x + 8 = 0$ for $x$ and $2y + 6 = 0$ for $y$ yields $(-2,3)$
    </p>

    <p>When performing a second partials test on $f$ we must first ensure that
        condition #1 of DEF 2 is satisfied. Since we did this (see above) we
        can use $f_{xx} = 4$, $f_{yy} = 2$, and $f_{xy} = 0$ in the following expression:
    </p>

    <p class="eq">
        $d = f_{xx}(a,b)f_{yy}(a,b) - [f_{xy}(a,b)]^2 = (4)(2) - [0]^2 = 8$
    </p>

    <p>Since $d > 0$ and $f_{xx} > 0$ we can conclude (by condition 1 of Theorem 13.17) that
        $f$ has a relative minimum at $(-2,3)$
    </p>

    <div class="breaker"></div>
    <!-- ********************************************************** -->
    <!-- ********************************************************** -->


    <h2>Example 2</h2>
    <p>Determine the relative extrema of</p>

    <p class="eq">
        $f(x,y) = 1 - (x^2 + y^2)^{1/3}$
    </p>

    <p>This function has partials: </p>

    <p class="eq">
        $f_x(x,y) = -\frac{2x}{3(x^2 + y^2)^{2/3}}$
    </p>

    <p>and</p>

    <p class="eq">
        $f_x(x,y) = -\frac{2y}{3(x^2 + y^2)^{2/3}}$
    </p>

    <p>
        The partials $f_x$ and $f_y$ are not defined at $(0,0)$. Setting
        both partials to equal to zero yields:
    </p>

    <p class="eq">$TODO$</p>

    <p>
        Using $(0,0)$ as the only critical point, we need to reason whether it is a
        maximum or minimum using DEF 1. There are two cases to consider. First is the
        test for a relative minimum:
    </p>

    <p class="eq">
        $\begin{align*}
        f(x,y) &>  f(0,0) & \quad {\small{(DEF\:1\:minimum)}}\\
        1 - (x^2 + y^2)^{1/3} &>  1 & \quad {\small{(substitute\:values)}}\\
        - (x^2 + y^2)^{1/3} &>  0 & \quad {\small{(subtract\:1\:from\:both\:sides)}}\\
        \end{align*}$
    </p>

    <p>For any $(x,y)$ (other than $(0,0)$) the expression $- (x^2 + y^2)^{1/3}$ will
        always be negative. Therefore $- (x^2 + y^2)^{1/3} > 0$ cannot be satisfied
        and we can conclude that the value f(0,0) is not a minimum. Using the same
        reasoning to test for a maximum:
    </p>

    <p class="eq">
        $\begin{align*}
        f(x,y) &<  f(0,0) & \quad {\small{(DEF\:1\:minimum)}}\\
        1 - (x^2 + y^2)^{1/3} &<  1 & \quad {\small{(substitute\:values)}}\\
        - (x^2 + y^2)^{1/3} &<  0 & \quad {\small{(subtract\:1\:from\:both\:sides)}}\\
        \end{align*}$
    </p>

    <p>Here we see that the inequality can be satisfied and can conclude that
        f(0,0) is a relative maximum.
    </p>


    <div class="breaker"></div>
    <!-- ********************************************************** -->
    <!-- ********************************************************** -->

    <h2>Example 3</h2>

    <p>Determine the relative extrema of</p>

    <p class="eq">
        $f(x,y) = -x^3 + 4xy - 2y^2 + 1$
    </p>

    <p>This function has partials: </p>

    <p class="eq">
        $f_x(x,y) = -3x^2 + 4y$
    </p>

    <p>and</p>

    <p class="eq">
        $f_x(x,y) = 4x - 4y$
    </p>

    <p>since the first partials are defined at every point, the only critical points of f
        are those which satisfy
    </p>

    <p class="eq">
        $-3x^2 + 4y = 0$ and $4x - 4y = 0$
    </p>

    <p>the second equation can be transformed into $x = y$. It can then be substituted back
        into the first equation in two differenet ways.
    </p>

    <p class="eq">
        $\begin{align*}
        x = &y\\
        -3x^2 + 4(x) = &0 \quad {\small{(x\:substituted\:for\:y)}}\\
        \end{align*}$
    </p>

    <p>this results in $x = y$ and $(x)(-3x + 4) = 0$, which gives us two critial points defined
        by $x = y, x = 0$ and $x = y, x = \frac{4}{3}$. We can also substitute back
        into the first equation in terms of $y$:
    </p>

    <p class="eq">
        $\begin{align*}
        x = &y\\
        -3(y)^2 + 4y = &0 \quad {\small{(y\:substituted\:for\:x)}}\\
        \end{align*}$
    </p>

    <p>Doing so, however, yields no new information (note: trying everypossible substitution
        is important - see <a href="#interesting">'An Interesting Exercise'</a>).
        The second partials needed in order to test our critical points: </p>

    <p class="eq">$f_{xx} = -6x$, $f_{yy} = -4$, and $f_{xy} = 4$</p>

    <p>the $d$ value for $(0,0)$ is $-16$ which indicates that $f(0,0)$ is a saddle point.
        the $d$ value for $(\frac{4}{3}, \frac{4}{3})$ is $16$ indicating that
        $f(\frac{4}{3}, \frac{4}{3})$ is a relative maximum.
    </p>

    <div class="breaker"></div>
    <!-- ********************************************************** -->
    <!-- ********************************************************** -->


    <h2 id="interesting">An Interesting Exercise</h2>
    <p>examine the function.</p>

    <p class="eq">
        $f(x,y) = (\frac{1}{2} + x^2 + y^2)e^{1 - x^2 - y^2}$
    </p>

    <p>This function has partials: </p>

    <p class="eq">
        $f_x(x,y) = (e^{1 - x^2 - y^2})(x)(-3 + 2x^2 - 2y^2)$
    </p>

    <p>and</p>

    <p class="eq">
        $f_x(x,y) = (e^{1 - x^2 - y^2})(x)(1 + 2x^2 - 2y^2)$
    </p>

    <p>This function has second partials: </p>

    <p class="eq">
        $\begin{align*}

        f_{xx}(x,y) &= -e^{1-x^2-y^2} (3 + 4x^4 + 2y^2 - 4x^2 ( 3 + y^2 ) )\\
        f_{yy}(x,y) &= e^{1-x^2-y^2} (1-8 y^2+4 y^4+x^2 (2-4 y^2))\\
        f_{xy}(x,y) &= -2 e^{1-x^2-y^2} x y (-1+2 x^2-2 y^2)\\

        \end{align*}$
    </p>

    <div class="breaker"></div>

    <p>CODE</p>
    <div class="highlight">
        <pre>
            <code class="language-python" data-lang="python">

import sympy as s

x, y = s.symbols('x y')

expr_f = (0.5 - x ** 2 + y ** 2) * (s.exp( 1 - x**2 - y**2 ))

expr_fx = s.diff(expr_f, x)
expr_fy = s.diff(expr_f, y)
expr_fxx = s.diff(expr_fx, x)
expr_fyy = s.diff(expr_fy, y)
expr_fxy = s.diff(expr_fx, y)

def EvalAt(a,b):
    return expr_f.subs(x,a).subs(y,b)

def Eval_fxx(a,b):
    return expr_fxx.subs(x,a).subs(y,b)

def SecondPartialTest(a,b):
    prodLeft = (expr_fxx.subs(x,a)).subs(y,b)
    prodRight = (expr_fyy.subs(x,a)).subs(y,b)
    subtractRight = ((expr_fxy.subs(x,a)).subs(y,b)) ** 2
    return prodRight*prodLeft - subtractRight

def spt(a,b):
    prodLeft = (expr_fxx.subs(x,a)).subs(y,b)
    prodRight = (expr_fyy.subs(x,a)).subs(y,b)
    subtractRight = ((expr_fxy.subs(x,a)).subs(y,b)) ** 2
    dVal = prodRight*prodLeft - subtractRight

    if (dVal.evalf() == 0):
        return "Inconclusive at (" + str(a) + ", " + str(b) + ")"

    elif ( dVal.evalf() < 0 ):
        return "Saddle Point at (" + str(a) + ", " + str(b) + ")"

    elif ( dVal.evalf() > 0 and prodLeft.evalf() > 0 ):
        return "Relative Minimum at (" + str(a) + ", " + str(b) + ")"

    elif ( dVal.evalf() > 0 and prodLeft.evalf() < 0 ):
        return "Relative Maximum at (" + str(a) + ", " + str(b) + ")"

    else:
        return "unreachable"


            </code>
        </pre>
    </div>

    <div class="breaker"></div>
    <p>OUTPUT</p>
    <div class="highlight">
        <pre>
            <code class="language-python" data-lang="python">

##############################################
## at (0,0) ##################################
##############################################
In [91]: SecondPartialTest(0,0)
Out[91]: -3.0*exp(2)

In [92]: EvalAt(0,0)
Out[92]: 0.5*E

In [125]: spt(0,0)
Out[125]: 'Saddle Point at (0, 0)'


##############################################
## at ( 0, 1 / sqrt(2) ) #####################
##############################################
In [93]: SecondPartialTest( 0, 1 / s.sqrt(2) )
Out[93]: 8.0*E

In [109]: Eval_fxx( 0, 1 / s.sqrt(2) )
Out[109]: -4.0*exp(1/2)

In [94]: EvalAt( 0, 1 / s.sqrt(2) )
Out[94]: 1.0*exp(1/2)

In [126]: spt( 0, 1 / s.sqrt(2) )
Out[126]: 'Relative Maximum at (0, sqrt(2)/2)'


##############################################
## at ( 0, - 1 / sqrt(2) ) ###################
##############################################
In [95]: SecondPartialTest( 0, - 1 / s.sqrt(2) )
Out[95]: 8.0*E

In [110]: Eval_fxx( 0, - 1 / s.sqrt(2) )
Out[110]: -4.0*exp(1/2)

In [96]: EvalAt( 0, - 1 / s.sqrt(2) )
Out[96]: 1.0*exp(1/2)

In [127]: spt( 0, - 1 / s.sqrt(2) )
Out[127]: 'Relative Maximum at (0, -sqrt(2)/2)'

##############################################
## at ( - s.sqrt(3) / s.sqrt(2), 0 ) #########
##############################################
In [103]: SecondPartialTest( - s.sqrt(3) / s.sqrt(2), 0 )
Out[103]: 24.0*exp(-1)

In [111]: Eval_fxx( - s.sqrt(3) / s.sqrt(2), 0 )
Out[111]: 6.0*exp(-1/2)

In [101]: EvalAt( - s.sqrt(3) / s.sqrt(2), 0 )
Out[101]: -1.0*exp(-1/2)

In [128]: spt( - s.sqrt(3) / s.sqrt(2), 0 )
Out[128]: 'Relative Minimum at (-sqrt(6)/2, 0)'

##############################################
## at ( s.sqrt(3) / s.sqrt(2), 0 ) ###########
##############################################
In [104]: SecondPartialTest( s.sqrt(3) / s.sqrt(2), 0 )
Out[104]: 24.0*exp(-1)

In [112]: Eval_fxx( s.sqrt(3) / s.sqrt(2), 0 )
Out[112]: 6.0*exp(-1/2)

In [102]: EvalAt( s.sqrt(3) / s.sqrt(2), 0 )
Out[102]: -1.0*exp(-1/2)

In [129]: spt( s.sqrt(3) / s.sqrt(2), 0 )
Out[129]: 'Relative Minimum at (sqrt(6)/2, 0)'

            </code>
        </pre>
    </div>
    <div class="breaker"></div>

    <img width="100%" src="../../images/interesting_problem.PNG">
    <div class="breaker"></div>

    <img width="100%" src="../../images/interesting_problem_contour.PNG">
    <div class="breaker"></div>
<!--
    <p>
        $\mathbf{x}_{n+1} = \mathbf{x}_{n} - \gamma_{n}\nabla f(\mathbf{x}_n), n \geq 0$
    </p>
-->


    <h2>Definitions</h2>

    <h3>DEF 1 - Relative Extrema</h3>
    <h3>DEF 2 - Critical Point</h3>

    <h2>Theorems</h2>

    <h3>THEOREM 13.17 - Second Partials Test</h3>

</div>




<!--








##############################################
## at (0,0) ##################################
##############################################
In [91]: SecondPartialTest(0,0)
Out[91]: -3.0*exp(2)

In [92]: EvalAt(0,0)
Out[92]: 0.5*E

In [125]: spt(0,0)
Out[125]: 'Saddle Point at (0, 0)'


##############################################
## at ( 0, 1 / sqrt(2) ) #####################
##############################################
In [93]: SecondPartialTest( 0, 1 / s.sqrt(2) )
Out[93]: 8.0*E

In [109]: Eval_fxx( 0, 1 / s.sqrt(2) )
Out[109]: -4.0*exp(1/2)

In [94]: EvalAt( 0, 1 / s.sqrt(2) )
Out[94]: 1.0*exp(1/2)

In [126]: spt( 0, 1 / s.sqrt(2) )
Out[126]: 'Relative Maximum at (0, sqrt(2)/2)'


##############################################
## at ( 0, - 1 / sqrt(2) ) ###################
##############################################
In [95]: SecondPartialTest( 0, - 1 / s.sqrt(2) )
Out[95]: 8.0*E

In [110]: Eval_fxx( 0, - 1 / s.sqrt(2) )
Out[110]: -4.0*exp(1/2)

In [96]: EvalAt( 0, - 1 / s.sqrt(2) )
Out[96]: 1.0*exp(1/2)

In [127]: spt( 0, - 1 / s.sqrt(2) )
Out[127]: 'Relative Maximum at (0, -sqrt(2)/2)'

##############################################
## at ( - s.sqrt(3) / s.sqrt(2), 0 ) #########
##############################################
In [103]: SecondPartialTest( - s.sqrt(3) / s.sqrt(2), 0 )
Out[103]: 24.0*exp(-1)

In [111]: Eval_fxx( - s.sqrt(3) / s.sqrt(2), 0 )
Out[111]: 6.0*exp(-1/2)

In [101]: EvalAt( - s.sqrt(3) / s.sqrt(2), 0 )
Out[101]: -1.0*exp(-1/2)

In [128]: spt( - s.sqrt(3) / s.sqrt(2), 0 )
Out[128]: 'Relative Minimum at (-sqrt(6)/2, 0)'

##############################################
## at ( s.sqrt(3) / s.sqrt(2), 0 ) ###########
##############################################
In [104]: SecondPartialTest( s.sqrt(3) / s.sqrt(2), 0 )
Out[104]: 24.0*exp(-1)

In [112]: Eval_fxx( s.sqrt(3) / s.sqrt(2), 0 )
Out[112]: 6.0*exp(-1/2)

In [102]: EvalAt( s.sqrt(3) / s.sqrt(2), 0 )
Out[102]: -1.0*exp(-1/2)

In [129]: spt( s.sqrt(3) / s.sqrt(2), 0 )
Out[129]: 'Relative Minimum at (sqrt(6)/2, 0)'


-->

</div>
</div>
</div>
</body>
</html>